
@{
    ViewBag.Title = "Trading";
}
<style>
    .form-check {
        display: inline;
    }

    .cb1-listbox {
        display: none;
    }
</style>
<h2>Manual Trading</h2>
<div class="row">
    <div class="col-5">

        <form>
            <div class="combobox combobox-list" id="SuggestionBox">

                <div class="form-group">
                    <label for="exampleInputIndex">Trading Symbol</label>


                    <select class="selectNew form-control" id="select2_example">
                        <option>Select Index Name</option>

                    </select>

                    @*<input type="text" class="form-control" id="exampleInputIndex" placeholder="Enter Index Name">

                        <select class="form-control" id="cb1-listbox" multiple></select>*@
                </div>


            </div>


            @*select2 example*@





            <div class="form-group">
                <label for="exampleInputPrice">Price</label>
                <input type="text" class="form-control" id="exampleInputPrice" placeholder="Enter Price">
            </div>
            <div class="form-group">
                <label for="exampleFormControlSelect1">Lot Size</label>
                <select class="form-control" id="exampleFormControlSelect1">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                </select>
            </div>


            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="Buy" value="Buy" checked>
                <label class="form-check-label" for="Buy">
                    Buy
                </label>
            </div>&nbsp;
            <div class="form-check">
                <input class="form-check-input" type="radio" name="exampleRadios" id="Sell" value="Sell">
                <label class="form-check-label" for="Sell">
                    Sell
                </label>
            </div>
            <br />
            <br />
            <button type="button" onclick="sendData()" class="btn btn-primary">Submit</button>
        </form>

    </div>

</div>




@section scripts{
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>


    <script>
        $(document).ready(function () {
            var pageSize = 20;

            $('#select2_example').select2(
                {
                   
                    ajax: {
                        /*delay: 150,*/
                        url: "/Trading/GetIndexList",
                        dataType: 'json',
                        data: function (params) {
                            return {
                                searchTerm: params.term
                                //pageSize: pageSize,
                                //pageNumber: params.page

                            };

                        },

                        processResults: function (data) {
                            debugger
                            /*  params.page = params.page || 1;*/
                            return {
                                results: data,
                                
                                //    pagination: {
                                //        more: (params.page * pageSize) < data.Total
                                //    }
                            };
                            debugger
                        }
                    },
                    placeholder: "-- Select --"
                    /* minimumInputLength: 0,*/
                    /*allowClear: true,*/
                });

        })
        



        function sendData() {
            var IndName = $("#exampleInputIndex").val();
            var price = $("#exampleInputPrice").val();
            var lotSize = $("#exampleFormControlSelect1").val();
            var transactionType = $("input[name='exampleRadios']:checked").val();
            var indexInsertData = { "IndexName": IndName, "Price": price, "LotSize": lotSize, "TrasactionType": transactionType };

            $.ajax({
                url: "/Trading/Index",
                type: "post",
                data: { "TradingModel": indexInsertData },
                success: function () {
                    alert("Data inserted sucessfully");
                    $("#exampleInputIndex").val('');
                    $("#exampleInputPrice").val('');
                    $("#exampleFormControlSelect1").val('');
                    $("#Buy").prop("checked", true);
                }
            });
        }

        $("#exampleInputIndex").keyup(function () {
            var startingKeyword = $(this).val();
            $.ajax({
                url: "/Trading/GetIndexNameAutoSuggestion",
                type: "post",
                data: { "keyword": startingKeyword },
                success: function (data) {
                    $("#cb1-listbox").empty();
                    $.each(data, function (index, item) {

                        $("#cb1-listbox").append('<option>' + item + '</option>');
                    })
                }
            });
        }).on('focusin', function () {
            $("#cb1-listbox").show();
        })

        $("#cb1-listbox").on('change', function () {
            var optionValue = $(this).val();
            $("#exampleInputIndex").val(optionValue);

        }).on('focusout', function () {

            $(this).hide();
        }).keypress(function (e) {
            var key = e.which;
            if (key == 13) {
                $(this).hide();
            }
        })


    </script>

}
